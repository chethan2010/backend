pipeline{
	agent{
		'Agent-1'
	}
	options{
	timeout(time:30, Units:'MINUTES')
	disable concurrent build()
	ansicolour('Xterm')
	}	
	params{}
	stages{
		stage('init'){
			steps{
				sh '''
				lt -ltr
				cd 01-vpc/
				terraform init -reconfigure
				'''
			}
		}
		
		stage('Plan'){
		when{
		expression{
			params.Action=='APPly'
		}
		}
			steps{
				sh '''
				cd 01-vpc/
				terraform plan
				'''
				}
				}
	   
	   stage('Deploy'){
	   when{
		expression{
			params.Action=='destroy'
        }
        }
			steps{
				sh '''
				cd 01-vpc/
				terraform destroy -auto-approve
				'''			
                }
    }

    post{

     always{

    echo 'I always say hello'
    deleteDir()
}
success{

    echo 'i will run when pipeline is success'
}
failure{

    echo 'i will run when pipe line is failure'
}
}
}


